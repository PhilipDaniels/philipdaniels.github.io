<!DOCTYPE html>
<html lang="en-us">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.53" />

    
    
    

<title>Setup of Debian Virtual Machines • Phil&#39;s Blog</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Setup of Debian Virtual Machines"/>
<meta name="twitter:description" content="Other Build Book Posts  Setup of SSH Windows VM Setup Network Setup in Hyper-V and Virtual Box  Posts in the Build Book sequence are intended primarily as an aide-mémoire for myself; a series of steps to go through for a consistent build experience. They tend to be to the point, prescriptive and tailored for me personally.
Installation Steps Pick the type of Debian distribution you want. I usually go for Testing to keep up with the latest fixes - it is a rolling release."/>

<meta property="og:title" content="Setup of Debian Virtual Machines" />
<meta property="og:description" content="Other Build Book Posts  Setup of SSH Windows VM Setup Network Setup in Hyper-V and Virtual Box  Posts in the Build Book sequence are intended primarily as an aide-mémoire for myself; a series of steps to go through for a consistent build experience. They tend to be to the point, prescriptive and tailored for me personally.
Installation Steps Pick the type of Debian distribution you want. I usually go for Testing to keep up with the latest fixes - it is a rolling release." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.philipdaniels.com/blog/2016/debian-vm-setup/" /><meta property="article:published_time" content="2016-12-27T20:19:45&#43;00:00"/>
<meta property="article:modified_time" content="2016-12-27T20:19:45&#43;00:00"/>


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/gruvbox-dark.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.3365924f1904a2c9b5991a4d079133052f247ee399df58b1a74e1119d7f49823.css" integrity="sha256-M2WSTxkEosm1mRpNB5EzBS8kfuOZ31ixp04RGdf0mCM=">


<link rel="stylesheet" href="/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="/favicon-128.png" sizes="128x128" />
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="/mstile-310x310.png" />

    

    
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-51573023-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
</head>


    <body class=" ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.philipdaniels.com/">Phil&#39;s Blog</a>
      </span>
      
      
        <div class="author-image">
          <img src="https://www.gravatar.com/avatar/5f3e5fe7d6a4062ad188336e06f1cb78?s=240&d=mp" class="img--circle img--headshot element--center" alt="gravatar">
        </div>
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Phil&#39;s Blog</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/blog">
						<span>Posts</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/gitcheatsheet">
						<span>My Git CheatSheet</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/about">
						<span>About</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	
	
	<a href="https://github.com/PhilipDaniels" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	<a href="https://stackoverflow.com/users/1313057/philip-daniels" rel="me"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="mailto:philip.daniels1971@gmail.com" rel="me"><i class="fas fa-at fa-lg" aria-hidden="true"></i></a>
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2019 Philip Daniels
  
</div>



  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1>Setup of Debian Virtual Machines</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> Dec 27, 2016
    
    
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/tags/linux">linux</a>
           
      
          <a class="badge badge-tag" href="/tags/vm">vm</a>
           
      
          <a class="badge badge-tag" href="/tags/debian">debian</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 5 min read
</div>


  </header>
  
  
  <div class="post">
    

<h2 id="other-build-book-posts">Other Build Book Posts</h2>

<ul>
<li><a href="https://www.philipdaniels.com/blog/2016/setup-of-ssh/">Setup of SSH</a></li>
<li><a href="https://www.philipdaniels.com/blog/2016/windows-vm-setup/">Windows VM Setup</a></li>
<li><a href="https://www.philipdaniels.com/blog/2016/vm-networking-overview/">Network Setup in Hyper-V and Virtual Box</a></li>
</ul>

<p>Posts in the Build Book sequence are intended primarily as an aide-mémoire for
myself; a series of steps to go through for a consistent build experience. They
tend to be to the point, prescriptive and tailored for me personally.</p>

<h2 id="installation-steps">Installation Steps</h2>

<p>Pick the
<a href="https://www.debian.org/doc/manuals/debian-faq/ch-choosing.en.html">type of Debian distribution</a>
you want. I usually go for Testing to keep up with the latest fixes - it is a
rolling release. Download a Testing netinst image for amd64 (for 64bit VMs) from
<a href="https://www.debian.org/devel/debian-installer/">https://www.debian.org/devel/debian-installer/</a>.</p>

<ul>
<li>Create a VM and add a network card. 1GB of RAM and 128GB of disk are OK.
Adjust CPUs to taste.</li>
<li>Do a graphical install.</li>
<li>If you are installing a machine with more than one network interface, you will
be asked to pick the primary one. Pick the first, as this should be the NAT one.</li>
<li>Hostname can be something simple, such as &ldquo;deb2&rdquo;.</li>
<li>Domain name can be &ldquo;debnet&rdquo;.</li>
<li><strong>DO NOT</strong> set a root password. By omitting it you force Debian to install
sudo. By default sudo is not installed and is a pain to add later, this trick
makes for an easier life.</li>
<li>New user: &ldquo;Philip Daniels&rdquo; for the full name, pick one word for the UID.</li>
<li>Partition: Guided, use entire disk. All files in one partition.</li>
<li>Configuring Package Manager proxy: this can be left blank at home. At work,
the corporate proxy should authenticate you, but if it doesn&rsquo;t the precise magic
to enter is in my password vault. See
<a href="https://www.philipdaniels.com/blog/2016/vm-networking-overview/">Network Setup in Hyper-V and Virtual Box</a></li>
<li>Software selection: typically I just go for &ldquo;SSH Server&rdquo; and &ldquo;standard system
utilities&rdquo;. It helps to keep the size down and everything else can be
installed later with apt-get anyway.</li>
<li>Install Grub, pick /dev/sda.</li>
<li>Done.</li>
</ul>

<h2 id="post-installation-setup">Post-Installation Setup</h2>

<h3 id="assign-a-static-ip">Assign a Static IP</h3>

<p>If at home, reserve a static IP on the router. At work, or to do it manually,
edit <code>/etc/network/interfaces</code>. See <code>man interfaces</code> for more info or browse the
<a href="https://wiki.debian.org/NetworkConfiguration">Debian Network Configuration Guide</a>.</p>

<p>Something like this is typically seen for a machine with a DHCP configured
interface:</p>

<pre><code># The primary network interface
allow-hotplug eth0
iface eth0 inet dhcp
</code></pre>

<p>The equivalent for a static IP is:</p>

<pre><code>auto eth0
iface eth0 inet static
    address 192.0.2.7
    netmask 255.255.255.0
    gateway 192.0.2.254         # Get this from route -n
</code></pre>

<p>At work, if using the standard Virtual Box setup described in
<a href="https://www.philipdaniels.com/blog/2016/vm-networking-overview/">Network Setup in Hyper-V and Virtual Box</a>,
then the stanza for the second NIC will look something like:</p>

<pre><code>auto enp0s8
iface enp0s8 inet static
    address 192.168.56.101
    netmask 255.255.255.0
    network 192.168.56.0
    broadcast 192.168.56.255
</code></pre>

<h3 id="edit-etc-hosts">Edit /etc/hosts</h3>

<p>See <a href="https://www.philipdaniels.com/blog/2016/vm-networking-overview/#simple-edit-the-hosts-file">here</a>.</p>

<h3 id="manual-dns-setup">Manual DNS Setup</h3>

<p>If you have at least one interface setup by DHCP then DNS servers should be
discovered automatically. If you do not, or you want to override them, they are
specified in <code>/etc/resolv.conf</code>. Typically it looks like this:</p>

<pre><code>nameserver 192.168.0.1
</code></pre>

<p>You can add as many lines as you want. Google has publicly available nameservers
at <code>8.8.8.8</code> and <code>8.8.8.4</code>.</p>

<h3 id="install-my-ssh-key-and-setup-forwarding">Install my ssh key and setup forwarding</h3>

<p><a href="https://www.philipdaniels.com/blog/2016/setup-of-ssh/#enabling-SSH-up-to-a-server">See my post on SSH</a>.</p>

<h3 id="setup-dotfiles">Setup dotfiles</h3>

<pre><code>mkdir -p ~/repos &amp;&amp; cd ~/repos
sudo apt-get install git
git clone git@github.com:PhilipDaniels/dotfiles
cd dotfiles
./00install_dotfiles.sh
./10install_linux_cli.sh
</code></pre>

<h2 id="getting-files-into-and-out-of-debian-vms">Getting files into and out of Debian VMs</h2>

<h3 id="using-filezilla">Using FileZilla</h3>

<p>For one-off file transfers, this is the easiest way. Basically, just setup SSH
on Windows and connect using FileZilla. Drag and drop files. See <a href="https://www.philipdaniels.com/blog/2016/setup-of-ssh/#using-ssh-with-windows-apps">SSH Setup</a> for precise
details.</p>

<h3 id="sharing-with-samba">Sharing with Samba</h3>

<p><a href="http://www.howtogeek.com/176471/how-to-share-files-between-windows-and-linux/">This guide</a>
is the best I have seen. Covers accessing a Windows share from Linux, and
creating a share in Linux which can be accessed from Windows.</p>

<p>One thing to bear in mind when accessing a Windows share - you need to pick
and/or create a Windows user. Options:</p>

<ol>
<li><p>Your day-to-day user. <strong>Pros:</strong> It will probably have the right permissions.
<strong>Cons:</strong> The user must have a password for this to work, not all Windows
users do. Also, if the password has to change then you will lose your mounts
whenever the pwd changes.</p></li>

<li><p>A new user, such as “unix”. <strong>Cons:</strong> Even making it an Administrator won&rsquo;t
give it full control over everything. For example, it will not be able to see
into your day-to-day user&rsquo;s home folder.</p></li>
</ol>

<p>The following commands may be useful for debugging purposes:</p>

<pre><code># Browse shares, n.b. there is no &quot;Phil&quot; account on hyperbox.
smbclient -L hyperbox -W workgroup -U hyperbox\\userid

sudo mount -t cifs //hyperbox/d ./hd -o username=userid,password=pwd,domain=hyperbox

# Puts you in a shell, you can do “ls”, “cd” etc. Good for checking.
smbclient \\\\hyperbox\\d -U hyperbox\\userid pwd
</code></pre>

<p>See also <a href="https://forums.gentoo.org/viewtopic-t-926114.html">https://forums.gentoo.org/viewtopic-t-926114.html</a> and
<a href="https://debian-handbook.info/browse/stable/sect.windows-file-server-with-samba.html">https://debian-handbook.info/browse/stable/sect.windows-file-server-with-samba.html</a></p>

<h3 id="permanent-mounting-with-etc-fstab">Permanent Mounting with /etc/fstab</h3>

<p>Create a directory(s) to serve as the mount point:</p>

<pre><code>cd /mnt
sudo mkdir c r s t
</code></pre>

<p>Add the following lines to <code>/etc/fstab</code> (where hyperbox is the Windows server):</p>

<pre><code># You may use spaces to separate fields. See &quot;man fstab&quot; for details of what each field is, and
# &quot;man mount&quot; and &quot;man mount.cifs&quot; for details of the options, but auto means can be mounted with
# &quot;mount -a&quot;, not that it is mounted automatically at boot time (they *all* are if they are in
# this file). The &quot;comment=&quot; is necessary to get the mounts to work at boot time (this is known to
# work on Debian Stretch as of July 2016).
//hyperbox/c$ /mnt/c cifs credentials=/home/phil/.smbcredentials,iocharset=utf8,rw,noperm,nounix,auto,comment=systemd.automount
//hyperbox/r$ /mnt/r cifs credentials=/home/phil/.smbcredentials,iocharset=utf8,rw,noperm,nounix,auto,comment=systemd.automount
//hyperbox/s$ /mnt/s cifs credentials=/home/phil/.smbcredentials,iocharset=utf8,rw,noperm,nounix,auto,comment=systemd.automount
//hyperbox/t$ /mnt/t cifs credentials=/home/phil/.smbcredentials,iocharset=utf8,rw,noperm,nounix,auto,comment=systemd.automount
</code></pre>

<p>Create a file <code>/home/phil/.smbcredentials</code> (actually it can be anywhere) to hold
your user id and password. Add the following lines (note no spaces):</p>

<pre><code>domain=hyperbox
username=user
password=password
</code></pre>

<p>And secure it:</p>

<pre><code>chmod 600 /home/phil/.smbcredentials
</code></pre>

<p>Then refresh mount points:</p>

<pre><code>sudo mount -a
</code></pre>

<p>If you make a mistake, to unmount something do:</p>

<pre><code>sudo umount /mnt/c
</code></pre>

<p>More info at <a href="https://wiki.ubuntu.com/MountWindowsSharesPermanently">https://wiki.ubuntu.com/MountWindowsSharesPermanently</a> and
<a href="https://wiki.centos.org/TipsAndTricks/WindowsShares">https://wiki.centos.org/TipsAndTricks/WindowsShares</a> (which also includes a
discussion of auto-mounting shares as and when needed).</p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="/blog/2016/setup-of-ssh/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Setup of ssh</span>
    </a>
    
    
    <a href="/blog/2016/vm-networking-overview/" class="navigation-next">
      <span class="navigation-tittle">Network Setup in Hyper-V and Virtual Box</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <div id="disqus_thread"></div>
<script type="text/javascript">
    

    (function () {
    if (location.hostname === "localhost" ||
      location.hostname === "127.0.0.1" ||
      location.hostname === "") {
      return;
    }
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    var disqus_shortname = 'philipdanielscomblog';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || 
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

<noscript>
  Please enable JavaScript to view the
  <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by
  <span class="logo-disqus">Disqus</span>
</a>

    


</article>


        </div>
        
    
  
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-51573023-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/rust.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/cs.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/bash.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/python.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/css.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/http.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/ini.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/javascript.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/json.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/markdown.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/sql.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/html.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/xml.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/dockerfile.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/scss.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/r.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/typescript.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/go.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/cpp.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/dos.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/plaintext.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/powershell.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/diff.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/makefile.min.js"></script>
            
                <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/languages/lisp.min.js"></script>
            
        
    
    <script type="text/javascript">
        
        hljs.configure({languages: ["rust, cs, bash, python, css, http, ini, javascript, json, markdown, sql, html, xml, dockerfile, scss, r, typescript, go, cpp, dos, plaintext, powershell, diff, makefile, lisp"]});
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
